# invest-strategy-testing

### Описание Тестируемой Стратегии Инвестирования

**Название стратегии**: Тестируемая стратегия еженедельного инвестирования в ETF

**Цель стратегии**:

- Максимизировать долгосрочные доходы через регулярные инвестиции с использованием как стандартных, так и левериджных ETF.

**Основные компоненты**:

1. **Инвестиционные активы**:
    - **QQQ** (Invesco QQQ Trust) - основной ETF, отслеживающий Nasdaq-100.
    - **QLD** (ProShares Ultra QQQ) - левериджный ETF с 2x дневной доходностью QQQ.
    - **TQQQ** (ProShares UltraPro QQQ) - левериджный ETF с 3x дневной доходностью QQQ.
2. **Периодичность инвестиций**:
    - Инвестиции осуществляются еженедельно по пятницам.
3. **Правила инвестирования**:
    - **Базовая инвестиция**: Каждую неделю инвестируется фиксированная сумма в долларах США.
    - **Адаптация к рынку**:
        - Если цена QQQ падает более чем на 20% от своего предыдущего максимума, инвестиции направляются в TQQQ.
        - Если цена QQQ падает более чем на 10%, но менее чем на 20% от своего предыдущего максимума, инвестиции направляются в QLD.
        - В остальных случаях инвестиции направляются в QQQ.
4. **Ребалансировка портфеля**:
    - Когда цена QQQ превышает свой предыдущий максимум, и в портфеле есть акции QLD или TQQQ:
        - Все акции QLD и TQQQ продаются при условии их прибыльности их удержания больше года.
        - Средства от продажи вместе с еженедельным инвестиционным взносом реинвестируются в QQQ.
5. **Оценка эффективности**:
    - Расчет доходности (ROI), составного годового роста (CAGR), максимальной просадки, а также отслеживание количества акций каждого ETF на конец тестового периода.

**Результаты тестирования**:

- Стратегия была протестирована за период с 2015-01-01 по 2024-12-31.
- Инвестиции: Еженедельно $100.
- Результаты включают сравнение с простой стратегией (без использования левериджных ETF), демонстрируя:
    - Общую сумму вложений.
    - Итоговую стоимость портфеля.
    - Итоговую прибыль.
    - Максимальную просадку.
    - ROI и CAGR.

**Визуализация**:

- График сравнивает доходность обеих стратегий, с дополнительными обозначениями:
    - Периоды, когда цена QQQ была на 10% ниже предыдущего максимума, отмечены оранжевым цветом.
    - Периоды, когда цена QQQ была на 20% ниже предыдущего максимума, отмечены красным цветом.

**Заключение**:

- Тестируемая стратегия показала потенциал для более высоких доходов по сравнению с простой стратегией, и с пониженным риском, как видно по меньшей максимальной просадке.

Извините за путаницу в моем предыдущем заключении. Согласно предоставленному вами отчету, данные показывают следующее:

**Простая стратегия**:

- Максимальная просадка: 31.02%

**Тестируемая стратегия**:

- Максимальная просадка: 23.32%

Это означает, что на самом деле тестируемая стратегия имела **меньшую** максимальную просадку по сравнению с простой стратегией, а не большую, как было неправильно указано в моем заключении.

**Пояснение**:

- **Максимальная просадка** (или drawdown) измеряет наибольшую потерю от пика до минимума в процентах от пика. В данном случае, тестируемая стратегия показала меньшую максимальную просадку (23.32%), что указывает на меньшую волатильность или более стабильное поведение портфеля в периоды снижения рынка по сравнению с простой стратегией (31.02%).
- **Причина меньшей просадки** в тестируемой стратегии может быть связана с использованием левериджных ETF (QLD и TQQQ), которые могут обеспечивать более высокие доходы в ростовых фазах рынка, но также могут смягчать потери в фазах снижения, особенно если стратегия включает переход на эти активы при определенных условиях падения цены QQQ.
- **Высокий ROI и CAGR** в тестируемой стратегии (673.29% и 21.01% соответственно) говорят о том, что несмотря на использование левериджных инструментов, стратегия управляла риском достаточно успешно, чтобы обеспечить значительный рост при меньшей просадке.

Таким образом, тестируемая стратегия не только превзошла по доходности простую стратегию, но и показала лучшую устойчивость к рыночным снижениям, что делает её более привлекательной для инвесторов, которые ценят как доходность, так и управление рисками.

### Как запустить скрипт
```
python3 -m venv path/to/venv                                                                                     
source path/to/venv/bin/activate
pip install yfinance pandas numpy matplotlib ta
python x.py 100 --start_date 2015-01-01 --end_date 2024-12-31 --ticker_1 QQQ --ticker_2 QLD --ticker_3 TQQQ --index QQQ --dropdown_1 0.10 --dropdown_2 0.20 
#Optional --skip_simple --skip_graf 
```

 ### Файл отчета
=== Простая стратегия покупки QQQ. 10 лет, каждую неделю по пятницам на $100. ===
- Общая сумма вложений: $52200.00
- Итоговая стоимость портфеля: $148568.25
- Итоговая прибыль: $96368.25
- Максимальная просадка: 31.02%
- ROI: 284.61%
- CAGR: 11.03%
- Количество акций QQQ: 284.31

=== Тестируемая стратегия. 10 лет, каждую неделю по пятницам QQQ, QLD или TQQQ ===
- Общая сумма вложений: $52200.00
- Итоговая стоимость портфеля: $351455.38
- Итоговая прибыль: $299255.38
- Максимальная просадка: 23.32%
- ROI: 673.29%
- CAGR: 21.01%
- Количество акций QQQ: 242.37, $123906.20, 35.26%
- Количество акций QLD: 178.37, $91190.17, 25.95%
- Количество акций TQQQ: 251.82, $128738.86, 36.63%
```